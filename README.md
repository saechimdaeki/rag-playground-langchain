# Retrieval Augmented Generation (RAG)

## 1. LLM 애플리케이션 개발에서 중요한 개념
- a. LLM 등장 전 NLP에서부터 사용됨
- b. 우리말로 하면 검색-증강 생성

1. Retrieval
- 데이터를 가져오는 것
- 구체적으로는 "컴퓨터 시스템에 저장된 자료를 취득하는 것" 이라는 뜻도 있음
- 언어모델이 가지고 있지 않은 정보를 가져오는것
  - 언어모델이 아웃풋을 만드는데 필요한 정보를 제공하는 것
  - 언어모델이 "답변 생성"에 능숙하지만 답변 생성을 위한 모든 정보를 가지고 있지는 않음
    - 보안이 걸려있는 사내 자료
    - GPT4는 23년 10월까지 정보를 가지고있음, GPT5는24년 6월
2. Augmented
- AR/VR에 사용되는 것과 같은 단어
- 마치 사실인 것처럼
- Retrieval된 데이터를 LLM에게 주면서 "마치 이 정보를 아는 것 처럼"

3. Generation
- 생성

----

그렇다면 나같은 개발자의 고민은?
- 답변을 생성하는 것은 LLM의 역할
- 우리는 데이터를 잘 가져와서
- LLM에게 잘 전달해야함

데이터를 잘 가져오려면?
- 일단 잘 저장해야한다
- 잘 저장하는것이 매우 어렵다

---

## 사용자가 원하는 정보

1. 사용자의 질문과 관련있는 데이터
- 관련이 있다는 것을 어떻게 판단할까?
- 관련성 파악을 위해 vector를 활용함
  - 단어 또는 문장의 유사도를 파악해서 관련성을 측정함
2. Vector를 생성하는 방법
- Embedding 모델을 활용해서 vector를 생성함
- 문장에서 비슷한 단어가 자주 붙어있는 것을 학습
  - 왕은 왕자의 아버지다
  - 여왕은 왕자의 어머니다
- '왕자의'라는 단어 앞에 등장하는 '왕'과 '여왕'은 유사할 가능성이 높다

### Vector Database

- Embedding 모델을 활용해 생성된 vector를 저장
  - 단순히 vector만 저장하면 안되고 metadata도 같이 저장
    - 이 항목이 상당히 중요
    - 문서의 이름, 페이지 번호 등등을 같이 저장 -> LLM이 생성하는 답변의 퀄리티가 상승
- Vector를 대상으로 유사도 검색 실시
  - 사용자의 질문과 가장 비슷한 문서를 가져오는 것 - Retrieval
  - 가져온 문서를 prompt를 통해 LLM에 제공 - Augmented
  - LLM은 prompt를 활용해서 답변 생성 - Generation

---

## LLM Evaluation의 중요성

서비스를 안정적으로 운영하기 위해서 (사용자가 정확한 정보를 받을 수 있는지)

"할루시네이션" -> "환각"
- LLM이 잘못된 답변을 생성하는 경우


## Dataset -> 도메인 전문가가 작성한 "정답지"

특정 질문이 들어오면 -> 이런 답변을 해야한다

ex) 1 + 1 = 2